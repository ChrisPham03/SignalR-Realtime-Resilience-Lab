<div class="dashboard">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-left">
      <h1>ğŸª Salon Admin Dashboard</h1>
      <p class="subtitle">Real-Time Appointment Monitoring</p>
    </div>
    <div class="header-right">
      <app-connection-status></app-connection-status>
    </div>
  </header>

  <!-- Notification Banner -->
  <div class="notification" *ngIf="notification" [@fadeInOut]>
    <span class="notification-icon">ğŸ””</span>
    {{ notification }}
  </div>

  <!-- Sync Status Bar -->
  <div class="sync-bar" *ngIf="isSyncing">
    <div class="sync-progress"></div>
    <span>Syncing appointments...</span>
  </div>

  <!-- Stats Bar -->
  <div class="stats-bar">
    <div class="stat">
      <span class="stat-value">{{ appointments.length }}</span>
      <span class="stat-label">Total Appointments</span>
    </div>
    <div class="stat">
      <span class="stat-value">{{ lastUpdated | date:'HH:mm:ss' }}</span>
      <span class="stat-label">Last Updated</span>
    </div>
    <button class="refresh-button" (click)="refresh()" [disabled]="isSyncing">
      ğŸ”„ Refresh
    </button>
  </div>

  <!-- Appointments List -->
  <main class="appointments-container">
    <div class="appointments-header">
      <h2>ğŸ“… Recent Bookings</h2>
      <span class="live-indicator">
        <span class="live-dot"></span>
        LIVE
      </span>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="appointments.length === 0 && !isSyncing">
      <span class="empty-icon">ğŸ“­</span>
      <p>No appointments yet</p>
      <small>New bookings will appear here in real-time</small>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="appointments.length === 0 && isSyncing">
      <div class="loader"></div>
      <p>Loading appointments...</p>
    </div>

    <!-- Appointments Grid -->
    <div class="appointments-grid" *ngIf="appointments.length > 0">
      <div 
        class="appointment-card" 
        *ngFor="let apt of appointments; trackBy: trackByAppointment"
        [class.new-highlight]="apt.createdAt === appointments[0]?.createdAt">
        
        <div class="card-header">
          <span class="customer-name">{{ apt.customerName }}</span>
          <span class="status-badge" [class]="getStatusClass(apt.status)">
            {{ apt.status }}
          </span>
        </div>

        <div class="card-body">
          <div class="service-info">
            <span class="service-type">âœ‚ï¸ {{ apt.serviceType }}</span>
            <span class="duration">{{ apt.durationMinutes }} min</span>
          </div>
          
          <div class="appointment-details">
            <div class="detail">
              <span class="label">ğŸ“</span>
              <span class="value">{{ apt.customerPhone }}</span>
            </div>
            <div class="detail">
              <span class="label">ğŸ‘¤</span>
              <span class="value">{{ apt.stylistName }}</span>
            </div>
            <div class="detail">
              <span class="label">ğŸ“…</span>
              <span class="value">{{ formatDate(apt.appointmentTime) }}</span>
            </div>
            <div class="detail">
              <span class="label">ğŸ’°</span>
              <span class="value">\${{ apt.price | number:'1.2-2' }}</span>
            </div>
          </div>

          <div class="notes" *ngIf="apt.notes">
            <span class="label">ğŸ“</span>
            <span class="value">{{ apt.notes }}</span>
          </div>
        </div>

        <div class="card-footer">
          <small class="created-at">Created: {{ formatTimeAgo(apt.createdAt) }}</small>
        </div>
      </div>
    </div>
  </main>

  <!-- Testing Panel (for lab purposes) -->
  <aside class="testing-panel">
    <h3>ğŸ§ª Lab Testing Info</h3>
    <p>To test connection recovery:</p>
    <ol>
      <li>Switch to another browser tab</li>
      <li>Wait 30+ seconds</li>
      <li>Return to this tab</li>
      <li>Observe: Missed appointments should sync automatically</li>
    </ol>
    <p class="tip">ğŸ’¡ Watch the connection indicator and console logs</p>
  </aside>
</div>
